---
###############################################################################
# ZFS Role Options
###############################################################################

# Last time ZFS options were validated against a default configuration.
zfs_role_validate_date: '2024-06-14'
zfs_role_validate_release: 'bookworm'

# Debian packages for ZFS support.
#
# Secure boot support is automatic once the DKMS keys are loaded. See
# r_pufky.srv.secure_boot.
#
# Reference:
# * https://openzfs.github.io/openzfs-docs/Getting%20Started/Debian/index.html
zfs_role_packages:
  - 'zfsutils-linux'
  - 'zfs-dkms'
  - 'dpkg-dev'
  # current kernel build files
  - 'linux-headers-{{ ansible_kernel }}'
  - 'linux-image-{{ ansible_kernel }}'
  # future kernel build files
  - 'linux-headers-amd64'
  - 'linux-image-amd64'

zfs_role_group:
  name: 'zfs_snapshot'
  gid: 901

zfs_role_user:
  name: 'zfs_snapshot'
  group: 'zfs_snapshot'
  groups:
    - '_ssh'
  uid: 901
  shell: '/bin/bash'
  home: '/etc/zfs_snapshot'
  create_home: true
  password: '!'
  password_lock: true
  update_password: 'always'
  expires: -1
  system: true
  extensions:
    sudoers:
      name: 'zfs_snapshot'
      user: 'zfs_snapshot'
      host: 'ALL'
      runas: 'ALL'
      nopassword: true
      commands: '/usr/sbin/zfs'
